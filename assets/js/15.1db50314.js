(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{365:function(t,e,r){t.exports=r.p+"assets/img/agdc.d3314b17.png"},366:function(t,e,r){t.exports=r.p+"assets/img/tsc.89adc3ad.png"},367:function(t,e,r){t.exports=r.p+"assets/img/asus-tsc.2397797f.png"},368:function(t,e,r){t.exports=r.p+"assets/img/asus-tsc-2.029ce318.png"},470:function(t,e,r){"use strict";r.r(e);var a=r(10),_=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"修复睡眠"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复睡眠"}},[t._v("#")]),t._v(" 修复睡眠")]),t._v(" "),e("p",[t._v("因此，为了理解如何解决macOS中的睡眠问题，我们需要首先看看大多数情况下是什么导致了睡眠问题:")]),t._v(" "),e("ul",[e("li",[t._v("设备管理错误(最常见的是基于PCIe的设备)")])]),t._v(" "),e("p",[t._v("原因是当设备获得S3调用(或S0用于唤醒)时，驱动程序需要关闭设备并进入低状态模式(唤醒时则相反)。当这些设备不与驱动程序合作时，问题就会出现，这些问题的主要违反者是:")]),t._v(" "),e("ul",[e("li",[t._v("USB控制器和设备")]),t._v(" "),e("li",[t._v("GPUs")]),t._v(" "),e("li",[t._v("Thunderbolt 控制器和设备")]),t._v(" "),e("li",[t._v("网卡(包括以太网和Wifi)")]),t._v(" "),e("li",[t._v("NVMe 驱动器")])]),t._v(" "),e("p",[t._v("还有一些其他可能导致睡眠问题的因素与PCI/e没有直接(或明显)关系:")]),t._v(" "),e("ul",[e("li",[t._v("CPU电源管理")]),t._v(" "),e("li",[t._v("显示")]),t._v(" "),e("li",[t._v("NVRAM")]),t._v(" "),e("li",[t._v("RTC/系统时钟")]),t._v(" "),e("li",[t._v("IRQ冲突")]),t._v(" "),e("li",[t._v("音频")]),t._v(" "),e("li",[t._v("SMBus")]),t._v(" "),e("li",[t._v("TSC")])]),t._v(" "),e("p",[t._v("很多人都忘记了一件事:")]),t._v(" "),e("ul",[e("li",[t._v("CPUs\n"),e("ul",[e("li",[t._v("AVX经常会破坏iGPUs并损害整体稳定性")])])]),t._v(" "),e("li",[t._v("坏内存(超频和不匹配的内存)\n"),e("ul",[e("li",[t._v("即使是糟糕/不匹配的时间也会导致严重的问题")])])]),t._v(" "),e("li",[t._v("工厂GPU超频\n"),e("ul",[e("li",[t._v("oem厂商通常在自定义VBIOS上对显卡做得有点过头")]),t._v(" "),e("li",[t._v("通常这些显卡会有一个物理开关，允许你选择低功耗的VBIOS")])])])]),t._v(" "),e("h2",{attrs:{id:"准备工作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#准备工作"}},[t._v("#")]),t._v(" 准备工作")]),t._v(" "),e("p",[e("strong",[t._v("在 macOS")]),t._v(":")]),t._v(" "),e("p",[t._v("在我们深入研究之前，我们首先要准备好我们的系统:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("sudo pmset autopoweroff 0\nsudo pmset powernap 0\nsudo pmset standby 0\nsudo pmset proximitywake 0\nsudo pmset tcpkeepalive 0\n")])])]),e("p",[t._v("这将为我们做5件事:")]),t._v(" "),e("ol",[e("li",[t._v("禁用自动休眠:这是休眠的一种形式")]),t._v(" "),e("li",[t._v("禁用powernap:用于定期唤醒机器以进行网络和更新(但不包括显示)")]),t._v(" "),e("li",[t._v("禁用待机:用于睡眠和进入休眠之间的一段时间")]),t._v(" "),e("li",[t._v("禁用iPhone/手表唤醒功能:特别是当你的iPhone或苹果手表靠近时，机器将唤醒")]),t._v(" "),e("li",[t._v("关闭TCP保持激活机制，防止每2小时唤醒一次")])]),t._v(" "),e("p",[e("strong",[t._v("在你的 config.plist")]),t._v(":")]),t._v(" "),e("p",[t._v("虽然只需要最小的更改，但以下是我们关心的更改:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("Misc -> Boot -> HibernateMode -> None")]),t._v(" "),e("ul",[e("li",[t._v("我们将避免使用S4的黑魔法")])])]),t._v(" "),e("li",[e("code",[t._v("NVRAM -> Add -> 7C436110-AB2A-4BBB-A880-FE41995C9F82 -> boot-args")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("keepsyms=1")]),t._v(" - 确保如果内核在睡眠期间发生崩溃，我们可以从中获取所有重要的信息")]),t._v(" "),e("li",[e("code",[t._v("swd_panic=1")]),t._v(" - 避免了睡眠导致重启的问题，这应该给我们一个内核崩溃日志")])])])]),t._v(" "),e("p",[e("strong",[t._v("在你的 BIOS")]),t._v(":")]),t._v(" "),e("ul",[e("li",[t._v("禁用：\n"),e("ul",[e("li",[t._v("Wake on LAN")]),t._v(" "),e("li",[t._v("Trusted Platform Module\n"),e("ul",[e("li",[t._v("请注意，如果你在Windows上使用BitLocker，禁用它将导致你所有的加密密钥丢失。如果你正在使用BitLocker，要么禁用，要么注意它可能是唤醒问题的原因。")])])]),t._v(" "),e("li",[t._v("Wake on USB(某些主板实际上可能需要这个来唤醒，但大多数将获得随机唤醒调用)")])])]),t._v(" "),e("li",[t._v("启用:\n"),e("ul",[e("li",[t._v("Wake on Bluetooth(如果使用蓝牙设备像键盘一样唤醒，否则可以禁用)")])])])]),t._v(" "),e("h2",{attrs:{id:"主要罪魁祸首"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主要罪魁祸首"}},[t._v("#")]),t._v(" 主要罪魁祸首")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#fixing-usb"}},[t._v("USB")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#fixing-gpus"}},[t._v("GPUs")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#fixing-thunderbolt"}},[t._v("Thunderbolt")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#fixing-nics"}},[t._v("网卡")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#fixing-nvme"}},[t._v("NVMe")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#fixing-cpu-power-management"}},[t._v("CPU电源管理")])])]),t._v(" "),e("h3",{attrs:{id:"修复usb"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复usb"}},[t._v("#")]),t._v(" 修复USB")]),t._v(" "),e("p",[t._v("这是导致黑苹果睡眠问题的首要原因，主要是因为苹果的驱动程序非常不擅长猜测端口，并且端口限制补丁会产生不稳定的不良影响。")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/usb/"}},[t._v("USB 映射")])],1)]),t._v(" "),e("p",[t._v("本指南还包括一些其他的修复，而不仅仅是映射:")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/usb/misc/power.html"}},[t._v("修复USB电源")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/usb/misc/shutdown.html"}},[t._v("修复关机/重启")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/usb/misc/instant-wake.html"}},[t._v("GPRW/UPRW/LANC即时唤醒补丁")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/usb/misc/keyboard.html"}},[t._v("键盘唤醒问题")])],1)]),t._v(" "),e("p",[e("strong",[t._v("使用macOS Catalina(10.15)及更新版本的USB映射")]),t._v(":你可能会发现，即使使用USB映射，你的睡眠时间也会延长。一个可能的解决方案是将IOClass的值从"),e("code",[t._v("AppleUSBMergeNub")]),t._v("重命名为"),e("code",[t._v("AppleUSBHostMergeProperties")]),t._v("。查看这里了解更多信息:"),e("a",{attrs:{href:"https://github.com/dortania/bugtracker/issues/15",target:"_blank",rel:"noopener noreferrer"}},[t._v("卡特琳娜USB IOClass的变化"),e("OutboundLink")],1)]),t._v(" "),e("ul",[e("li",[t._v("注意:某些USB设备在macOS中没有正确的驱动程序，可能会不幸导致睡眠问题。例如，带有USB寻址控制的海盗船水冷可以防止机器正常睡眠。对于这些情况，我们建议用户在调试睡眠问题时断开这些麻烦的设备。")])]),t._v(" "),e("h3",{attrs:{id:"修复gpus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复gpus"}},[t._v("#")]),t._v(" 修复GPUs")]),t._v(" "),e("p",[t._v("有了gpu，我们很容易就能知道是什么导致了问题。这是macOS中不支持的gpu。默认情况下，任何没有在操作系统中提供驱动程序的GPU都将运行非常基本的驱动程序，即VESA驱动程序。它们提供了最小的显示输出，但也导致了一个大问题，即macOS实际上不知道如何正确地与这些设备交互。要解决这个问题，我们需要欺骗macOS认为它是一个通用的PCIe设备(它可以更好地处理，非常适合台式机)，或者完全关闭卡(在笔记本电脑上，台式机dgpu有关机问题)")]),t._v(" "),e("ul",[e("li",[t._v("查看更多信息:\n"),e("ul",[e("li",[e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/Desktops/desktop-disable",target:"_blank",rel:"noopener noreferrer"}},[t._v("禁用桌面显卡"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/Laptops/laptop-disable",target:"_blank",rel:"noopener noreferrer"}},[t._v("禁用笔记本显卡"),e("OutboundLink")],1)])])])]),t._v(" "),e("p",[t._v("10.15.4及更新版本iGPU用户的特别说明:")]),t._v(" "),e("ul",[e("li",[t._v("iGPU唤醒部分是由于苹果公司在真正的mac上使用applegraphicpowermanagement.kext的大量黑客行为造成的，为了解决这个问题，你可能需要"),e("code",[t._v("igfxonln=1")]),t._v("来强制所有显示在线。显然，首先要进行测试，以确保您有这个问题。")]),t._v(" "),e("li",[t._v("A对于桌面 Coffee Lake (UHD 630) 的用户来说，AAPL,ig-platform-id "),e("code",[t._v("07009B3E")]),t._v("可能会失败，你可以试试"),e("code",[t._v("00009B3E")]),t._v("。"),e("code",[t._v("0300923E")]),t._v("有时也是有效的。")])]),t._v(" "),e("p",[t._v("其他iGPU注意事项:")]),t._v(" "),e("ul",[e("li",[t._v("一些使用igpu的系统(例如Kaby Lake和Coffee Lake)可能会在低功耗状态下导致系统不稳定，有时会表现为NVMe内核崩溃。要解决这个问题，你可以在你的引导参数中添加"),e("code",[t._v("forceRenderStandby=0")]),t._v("来禁用RC6备用渲染。查看这里了解更多信息:"),e("a",{attrs:{href:"https://github.com/acidanthera/bugtracker/issues/1193",target:"_blank",rel:"noopener noreferrer"}},[t._v("IGP导致NVMe内核恐慌CSTS=0xffffffff#1193"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("由于转换状态的问题，某些Ice Lake笔记本电脑也可能在“不允许DC6而不允许DC9”时出现内核崩溃。一种解决方法是在你的启动参数中使用"),e("code",[t._v("-noDC9")]),t._v("或"),e("code",[t._v("-nodisplaysleepDC6")])])]),t._v(" "),e("p",[t._v("AMD dgpu 4k显示器的特别注意事项:")]),t._v(" "),e("ul",[e("li",[t._v("某些显示器可能无法随机唤醒，主要是由AGDC首选项引起的。要修复这个问题，请在DeviceProperties中将其应用到dGPU上:\n"),e("ul",[e("li",[e("code",[t._v("CFG,CFG_USE_AGDC | Data | 00")])]),t._v(" "),e("li",[t._v("你可以通过"),e("a",{attrs:{href:"https://github.com/acidanthera/gfxutil/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("gfxutil"),e("OutboundLink")],1),t._v("找到GPU的PciRoot\n"),e("ul",[e("li",[e("code",[t._v("/path/to/gfxutil -f GFX0")])])])])])])]),t._v(" "),e("p",[e("img",{attrs:{src:r(365),alt:""}})]),t._v(" "),e("h3",{attrs:{id:"修复thunderbolt"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复thunderbolt"}},[t._v("#")]),t._v(" 修复Thunderbolt")]),t._v(" "),e("p",[t._v("Thunderbolt在社区中是一个非常棘手的话题，主要是由于情况的复杂性。如果你想让Thunderbolt和sleep同时工作，你真的只有两条路可走:")]),t._v(" "),e("ul",[e("li",[t._v("在BIOS中禁用Thunderbolt 3")]),t._v(" "),e("li",[t._v("尝试修补Thunderbolt 3:\n"),e("ul",[e("li",[e("a",{attrs:{href:"https://osy.gitbook.io/hac-mini-guide/details/thunderbolt-3-fix/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Thunderbolt 3 修复"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/osy86/ThunderboltReset",target:"_blank",rel:"noopener noreferrer"}},[t._v("ThunderboltReset"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/al3xtjames/ThunderboltPkg/blob/master/Docs/FAQ.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("ThunderboltPkg"),e("OutboundLink")],1)])])])]),t._v(" "),e("p",[t._v("注意:Thunderbolt可以在不需要额外工作的情况下启用，"),e("strong",[t._v("如果")]),t._v("你不需要睡眠也没问题，反之亦然。")]),t._v(" "),e("h3",{attrs:{id:"修复网卡"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复网卡"}},[t._v("#")]),t._v(" 修复网卡")]),t._v(" "),e("p",[t._v("网卡(网络接口控制器)与睡眠很容易修复,主要是以下几点:")]),t._v(" "),e("ul",[e("li",[t._v("在BIOS中禁用WakeOnLAN\n"),e("ul",[e("li",[t._v("大多数系统将进入睡眠/唤醒循环启用")])])]),t._v(" "),e("li",[t._v("在macOS中禁用"),e("code",[t._v("Wake for network access")]),t._v(" (SystemPreferences -> Power)\n"),e("ul",[e("li",[t._v("似乎能破解很多hack")])])])]),t._v(" "),e("h3",{attrs:{id:"修复nvme"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复nvme"}},[t._v("#")]),t._v(" 修复NVMe")]),t._v(" "),e("p",[t._v("所以macOS对NVMe驱动非常挑剔，而且苹果的电源管理驱动仅限于苹果品牌的驱动。所以要做的主要事情是:")]),t._v(" "),e("ul",[e("li",[t._v("确保NVMe在最新固件上(对于"),e("a",{attrs:{href:"https://www.tonymacx86.com/threads/do-the-samsung-970-evo-plus-drives-work-new-firmware-available-2b2qexm7.270757/page-14#post-1960453",target:"_blank",rel:"noopener noreferrer"}},[t._v("970 Evo Plus驱动器"),e("OutboundLink")],1),t._v("尤其重要)")]),t._v(" "),e("li",[t._v("使用"),e("a",{attrs:{href:"https://github.com/acidanthera/NVMeFix/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("NVMeFix.kext"),e("OutboundLink")],1),t._v("来进行适当的NVMe电源管理")])]),t._v(" "),e("p",[t._v("并避免问题驱动，主要罪魁祸首:")]),t._v(" "),e("ul",[e("li",[t._v("三星的PM981和PM991固态硬盘")]),t._v(" "),e("li",[t._v("Micron的2200S")])]),t._v(" "),e("p",[t._v("如果你的系统中有这些驱动器，最好通过SSDT禁用它们:"),e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/Desktops/desktop-disable.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("禁用桌面dgpu"),e("OutboundLink")],1),t._v("。\n本指南主要针对dGPU，但对NVMe驱动器的工作原理完全相同(因为它们都只是PCIe设备)。")]),t._v(" "),e("h3",{attrs:{id:"修复cpu电源管理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修复cpu电源管理"}},[t._v("#")]),t._v(" 修复CPU电源管理")]),t._v(" "),e("p",[e("strong",[t._v("来自 Intel")]),t._v(":")]),t._v(" "),e("p",[t._v("要验证您是否有工作的CPU电源管理，请参阅"),e("RouterLink",{attrs:{to:"/universal/pm.html"}},[t._v("固定电源管理")]),t._v(" page.")],1),t._v(" "),e("p",[t._v("还要注意，不正确的电源管理数据可能导致唤醒问题，因此请验证您正在使用正确的SMBIOS。")]),t._v(" "),e("p",[t._v("一个常见的内核唤醒错误是:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("Sleep Wake failure in EFI\n")])])]),e("p",[e("strong",[t._v("来自 AMD")]),t._v(":")]),t._v(" "),e("p",[t._v("不要着急，因为他们对你还有希望"),e("img",{attrs:{src:"https://github.com/trulyspinach/SMCAMDProcessor",alt:"AMDRyzenCPUPowerManagement.kext"}}),t._v("可以添加基于Ryzen cpu电源管理。仓库的README.md中解释了安装和使用方法")]),t._v(" "),e("h2",{attrs:{id:"其他罪魁祸首"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#其他罪魁祸首"}},[t._v("#")]),t._v(" 其他罪魁祸首")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#displays"}},[t._v("显示")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#nvram"}},[t._v("NVRAM")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#rtc"}},[t._v("RTC")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#irq-conflicts"}},[t._v("IRQ 冲突")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#audio"}},[t._v("音频")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#smbus"}},[t._v("SMBus")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#tsc"}},[t._v("TSC")])])]),t._v(" "),e("h3",{attrs:{id:"显示"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#显示"}},[t._v("#")]),t._v(" 显示")]),t._v(" "),e("p",[t._v("所以显示问题主要是针对笔记本电脑的盖子检测，具体来说:")]),t._v(" "),e("ul",[e("li",[t._v("错误制作SSDT-PNLF")]),t._v(" "),e("li",[t._v("操作系统与固件的盖子唤醒")]),t._v(" "),e("li",[t._v("键盘垃圾从盖子唤醒它(基于PS2的键盘)")])]),t._v(" "),e("p",[t._v("前者很容易修复，参见这里:"),e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/",target:"_blank",rel:"noopener noreferrer"}},[t._v("背光PNLF"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("对于中间部分，macOS的盖子唤醒检测可能有点坏，你可能需要完全禁用它:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" pmset lidwake "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n")])])]),e("p",[t._v("并设置"),e("code",[t._v("lidwake 1")]),t._v("来重新启用它。")]),t._v(" "),e("p",[t._v("后者需要更多的工作。我们要做的是试图消除在Skylake和更新的基于HPs上发生的半随机密钥垃圾邮件，尽管在其他oem中也会出现。这也将假设你的键盘是基于PS2并且正在运行"),e("a",{attrs:{href:"https://github.com/acidanthera/VoodooPS2/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("VoodooPS2"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("要解决这个问题，请获取"),e("a",{attrs:{href:"https://github.com/acidanthera/VoodooPS2/blob/master/Docs/ACPI/SSDT-HP-FixLidSleep.dsl",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSDT-HP-FixLidSleep.dsl"),e("OutboundLink")],1),t._v("并将ACPI路径调整到您的键盘("),e("code",[t._v("_CID")]),t._v("值为"),e("code",[t._v("PNP0303")]),t._v(")。一旦完成，编译并放入EFI/OC/ACPI和config plist -> ACPI -> Add。")]),t._v(" "),e("p",[t._v("对于99%的HP用户来说，这将解决随机密钥的垃圾问题。如果没有，请参阅下面的帖子:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.tonymacx86.com/threads/guide-patching-dsdt-ssdt-for-laptop-backlight-control.152659/",target:"_blank",rel:"noopener noreferrer"}},[t._v("RehabMan的亮度键指南"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"nvram"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nvram"}},[t._v("#")]),t._v(" NVRAM")]),t._v(" "),e("p",[t._v("要验证您有工作的NVRAM，请参阅[模拟NVRAM](../misc/ NVRAM. md)页面来验证您有工作的NVRAM。如果没有，则相应地打补丁。")]),t._v(" "),e("h3",{attrs:{id:"rtc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#rtc"}},[t._v("#")]),t._v(" RTC")]),t._v(" "),e("p",[t._v("这主要与Intel 300系列主板(Z3xx)有关，具体来说有两个问题:")]),t._v(" "),e("ul",[e("li",[t._v("默认RTC是禁用的(而不是使用AWAC)")]),t._v(" "),e("li",[t._v("RTC通常与macOS不兼容")])]),t._v(" "),e("p",[t._v("要解决第一个问题，请参阅这里:"),e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/Universal/awac.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("修复AWAC"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("对于第二个问题，当您关闭或重新启动时，很容易告诉您有RTC问题。具体来说，你会看到一个“BIOS重启在安全模式”的错误。为了解决这个问题，我们需要防止macOS向RTC 区域写入数据导致这些问题。这里有几个修复方法:")]),t._v(" "),e("ul",[e("li",[t._v("DisableRtcChecksum: 防止写入主校验和(0x58-0x59)，适用于大多数主板")]),t._v(" "),e("li",[e("code",[t._v("UEFI -> ProtoclOverride -> AppleRtcRam")]),t._v(" + "),e("code",[t._v("NVRAM -> Add -> rtc-blacklist")]),t._v(" "),e("ul",[e("li",[t._v("在固件级别上黑名单某些区域，参见"),e("a",{attrs:{href:"https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Configuration.pdf",target:"_blank",rel:"noopener noreferrer"}},[t._v("Configuration.pdf"),e("OutboundLink")],1),t._v("关于如何设置的更多信息")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/acidanthera/RTCMemoryFixup",target:"_blank",rel:"noopener noreferrer"}},[t._v("RTCMemoryFixup"),e("OutboundLink")],1),t._v(" + "),e("code",[t._v("rtcfx_exclude=")]),t._v(" "),e("ul",[e("li",[t._v("在内核级别将某些区域列入黑名单，参见README了解更多关于如何设置的信息")])])])]),t._v(" "),e("p",[t._v("对于一些legacy的板，你可能需要给你的RTC打补丁:"),e("a",{attrs:{href:"https://www.insanelymac.com/forum/topic/329624-need-cmos-reset-after-sleep-only-after-login/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Z68 RTC"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"irq-冲突"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#irq-冲突"}},[t._v("#")]),t._v(" IRQ 冲突")]),t._v(" "),e("p",[t._v("IRQ问题通常发生在启动过程中，但有些人可能会注意到IRQ调用可以中断与睡眠，这个修复是相当容易的:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/corpnewt/SSDTTime",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSDTTime"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("首先将DSDT转储到Linux/Windows中")]),t._v(" "),e("li",[t._v("然后选择"),e("code",[t._v("FixHPET")]),t._v("选项")])])])]),t._v(" "),e("p",[t._v("这将为您提供SSDT- hpet.aml和"),e("code",[t._v("patches_OC.plist")]),t._v("，您需要将SSDT添加到EFI/OC/ACPI，并从patches_OC.plist将ACPI补丁添加到您的config.plist中")]),t._v(" "),e("h3",{attrs:{id:"音频"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#音频"}},[t._v("#")]),t._v(" 音频")]),t._v(" "),e("p",[t._v("未管理或不正确管理的音频设备也可能导致问题，要么在BIOS中禁用未使用的音频设备，要么在这里验证它们是否正常工作:")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/universal/audio.html"}},[t._v("修复音频")])],1)]),t._v(" "),e("h3",{attrs:{id:"smbus"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#smbus"}},[t._v("#")]),t._v(" SMBus")]),t._v(" "),e("p",[t._v("您关心SMBus的主要原因是AppleSMBus可以帮助正确管理SMBus和PCI设备，如电源状态。问题是kext通常不会自己加载，因此您需要实际创建SSDT-SMBS-MCHC。")]),t._v(" "),e("p",[t._v("看这里关于如何使它的更多信息:"),e("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/Universal/smbus.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("修复SMBus支持"),e("OutboundLink")],1)]),t._v(" "),e("h3",{attrs:{id:"tsc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tsc"}},[t._v("#")]),t._v(" TSC")]),t._v(" "),e("p",[t._v("TSC(时间戳计数器)负责确保你的硬件以正确的速度运行，问题是一些固件(主要是HEDT/服务器和华硕笔记本电脑)不会将TSC写入所有核心，从而导致问题。为了解决这个问题，我们有三个选择:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/lvs1974/CpuTscSync/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("CpuTscSync"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("针对麻烦的笔记本电脑")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://bitbucket.org/RehabMan/VoodooTSCSync/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("VoodooTSCSync"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("用于大多数HEDT硬件")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/interferenc/TSCAdjustReset",target:"_blank",rel:"noopener noreferrer"}},[t._v("TSCAdjustReset"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("用于Skylake X/W/SP和Cascade Lake X/W/SP硬件")])])])]),t._v(" "),e("p",[t._v("前两个是即插即用，而后者需要一些定制:")]),t._v(" "),e("ul",[e("li",[t._v("打开kext(在访达中显示包内容， "),e("code",[t._v("Contents -> Info.plist")]),t._v(")并更改Info plist -> "),e("code",[t._v("IOKitPersonalities -> IOPropertyMatch -> IOCPUNumber")]),t._v("为从"),e("code",[t._v("0")]),t._v("开始的CPU线程数(i9 7980xe 18核心将是"),e("code",[t._v("35")]),t._v("，因为它总共有36个线程)")]),t._v(" "),e("li",[t._v("编译后的版本可以在这里找到:"),e("a",{attrs:{href:"https://github.com/dortania/OpenCore-Install-Guide/blob/master/extra-files/TSCAdjustReset.kext.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("tscadjustreet .kext"),e("OutboundLink")],1)])]),t._v(" "),e("p",[e("img",{attrs:{src:r(366),alt:""}})]),t._v(" "),e("p",[t._v("查看TSC问题的最常见方法:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("案例 1")]),t._v(" "),e("th",{staticStyle:{"text-align":"center"}},[t._v("案例 2")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"center"}},[e("img",{attrs:{src:r(367),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"center"}},[e("img",{attrs:{src:r(368),alt:""}})])])])])])}),[],!1,null,null,null);e.default=_.exports}}]);