(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{454:function(e,a,t){"use strict";t.r(a);var v=t(10),s=Object(v.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"模拟nvram"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模拟nvram"}},[e._v("#")]),e._v(" 模拟NVRAM")]),e._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[e._v("危险")]),e._v(" "),a("p",[e._v("这不是OpenCore 0.8.3的最新版本!")])]),e._v(" "),a("p",[e._v("所以本节是为那些没有原生NVRAM的人准备的，与macOS不兼容的原生NVRAM的最常见硬件是X99和一些X299系列芯片组。")]),e._v(" "),a("ul",[a("li",[e._v("X99")]),e._v(" "),a("li",[e._v("X299")])]),e._v(" "),a("p",[e._v("对于B360、B365、H310、H370和Z390用户，确保你在EFI/OC/ACPI和config.plist -> ACPI -> Add下都有"),a("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSDT-PMC"),a("OutboundLink")],1),e._v("。关于制作和编译SSDT的更多信息，请看 "),a("a",{attrs:{href:"https://sumingyd.github.io/Getting-Started-With-ACPI/",target:"_blank",rel:"noopener noreferrer"}},[a("strong",[e._v("开始使用ACPI")]),a("OutboundLink")],1)]),e._v(" "),a("h2",{attrs:{id:"清理clover的垃圾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#清理clover的垃圾"}},[e._v("#")]),e._v(" 清理Clover的垃圾")]),e._v(" "),a("p",[e._v("有些人可能没有注意到，但Clover可能已经在macOS中安装了RC脚本，以进行适当的NVRAM模拟。这是一个问题，因为它与OpenCore的模拟方法相冲突。")]),e._v(" "),a("p",[e._v("要删除的文件。")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("/Volumes/EFI/EFI/CLOVER/drivers64UEFI/EmuVariableUefi-64.efi")])]),e._v(" "),a("li",[a("code",[e._v("/Volumes/EFI/nvram.plist")])]),e._v(" "),a("li",[e._v("`/etc/rc.clover.lib'")]),e._v(" "),a("li",[a("code",[e._v("/etc/rc.boot.d/10.save_and_rotate_boot_log.local")])]),e._v(" "),a("li",[a("code",[e._v("/etc/rc.boot.d/20.mount_ESP.local")])]),e._v(" "),a("li",[a("code",[e._v("/etc/rc.boot.d/70.disable_sleep_proxy_client.local.disabled")])]),e._v(" "),a("li",[a("code",[e._v("/etc/rc.shutdown.d/80.save_nvram_plist.local")])])]),e._v(" "),a("p",[e._v("如果文件夹是空的，也要删除它们。")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("/etc/rc.boot.d")])]),e._v(" "),a("li",[a("code",[e._v("/etc/rc.shutdown.d")])])]),e._v(" "),a("h2",{attrs:{id:"验证你是否有工作的nvram"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证你是否有工作的nvram"}},[e._v("#")]),e._v(" 验证你是否有工作的NVRAM")]),e._v(" "),a("p",[e._v("首先，打开终端，运行以下命令，在NVRAM中设置一个名为"),a("code",[e._v("test")]),e._v("的变量为当前日期和时间。")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" nvram "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("myvar")]),a("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[e._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("date")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v('"')]),e._v("\n")])])]),a("p",[e._v("现在重新启动并运行这个命令。")]),e._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[e._v("nvram myvar\n")])])]),a("p",[e._v("如果没有返回，那么你的NVRAM就没有工作。如果有一行包含"),a("code",[e._v("myvar")]),e._v("，然后是当前日期，那么你的NVRAM就工作了。")]),e._v(" "),a("h2",{attrs:{id:"模拟nvram-使用nvram-plist"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模拟nvram-使用nvram-plist"}},[e._v("#")]),e._v(" 模拟NVRAM(使用"),a("code",[e._v("nvram.plist")]),e._v(")")]),e._v(" "),a("p",[e._v("如果你没有本地的NVRAM，不要着急。我们可以通过使用脚本来设置模拟NVRAM，在关机过程中将NVRAM内容保存到plist中，然后在下次启动时由OpenCore加载。")]),e._v(" "),a("p",[e._v("要启用模拟NVRAM，你需要进行以下设置。")]),e._v(" "),a("p",[e._v("在你的config.plist中：")]),e._v(" "),a("ul",[a("li",[a("strong",[e._v("Booter -> Quirks")]),e._v("。\n"),a("ul",[a("li",[a("code",[e._v("DisableVariableWrite")]),e._v("：设置为"),a("code",[e._v("NO")])])])]),e._v(" "),a("li",[a("strong",[e._v("Misc -> Security")]),e._v(":\n"),a("ul",[a("li",[a("code",[e._v("ExposeSensitiveData")]),e._v(": 设置为至少"),a("code",[e._v("0x1")])])])]),e._v(" "),a("li",[a("strong",[e._v("NVRAM")]),e._v(":\n"),a("ul",[a("li",[a("code",[e._v("LegacyOverwrite")]),e._v("设置为"),a("code",[e._v("YES")])]),e._v(" "),a("li",[a("code",[e._v("LegacySchema")]),e._v(": 设置NVRAM变量（OpenCore将这些变量与"),a("code",[e._v("nvram.plist")]),e._v("中的变量进行比较）")]),e._v(" "),a("li",[a("code",[e._v("WriteFlash")]),e._v("：设置为"),a("code",[e._v("YES")])])])])]),e._v(" "),a("p",[e._v("而在你的EFI中：")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("OpenVariableRuntimeDxe.efi")]),e._v("驱动程序")]),e._v(" "),a("li",[a("code",[e._v("OpenRuntime.efi")]),e._v(" 驱动程序 (这对于正确的睡眠、关机和其他服务的正常工作是必需的)")])]),e._v(" "),a("p",[e._v("确保在快照之后，确保这些驱动被列在你的config.plist中。之后，确保"),a("code",[e._v("OpenVariableRuntimeDxe.efi")]),e._v("和"),a("code",[e._v("OpenRuntime.efi")]),e._v("的"),a("code",[e._v("LoadEarly")]),e._v("设置为"),a("code",[e._v("YES")]),e._v("，并且"),a("code",[e._v("OpenVariableRuntimeDxe.efi")]),e._v("在你的配置中被置于"),a("code",[e._v("OpenRuntime.efi")]),e._v("之前。")]),e._v(" "),a("p",[e._v("现在抓取"),a("a",{attrs:{href:"https://github.com/acidanthera/OpenCorePkg/releases",target:"_blank",rel:"noopener noreferrer"}},[e._v("LogoutHook文件夹"),a("OutboundLink")],1),e._v("(在"),a("code",[e._v("Utilities")]),e._v("内)并把它放在安全的地方(例如在你的用户目录内，如下所示)")]),e._v(" "),a("p",[a("code",[e._v("/Users/$(whoami)/LogoutHook/")])]),e._v(" "),a("p",[e._v("打开终端，运行以下程序（一次一个）。")]),e._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("cd")]),e._v(" /Users/"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[e._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("whoami")]),a("span",{pre:!0,attrs:{class:"token variable"}},[e._v(")")])]),e._v("/LogoutHook/\n./Launchd.command "),a("span",{pre:!0,attrs:{class:"token function"}},[e._v("install")]),e._v(" \n")])])]),a("p",[e._v("然后就可以了! 你有了模拟的NVRAM!")])])}),[],!1,null,null,null);a.default=s.exports}}]);