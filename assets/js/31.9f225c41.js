(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{300:function(t,e,a){t.exports=a.p+"assets/img/vram.9d04ab0c.png"},448:function(t,e,a){"use strict";a.r(e);var l=a(10),s=Object(l.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"给vram打补丁"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#给vram打补丁"}},[t._v("#")]),t._v(" 给VRAM打补丁")]),t._v(" "),e("p",[t._v("本节主要与那些不能解锁BIOS以增加分配给iGPU的VRAM的用户有关，这将导致macOS的内核崩溃。为了解决这个问题，我们首先要确定帧缓冲器所需的最小VRAM量，然后打补丁使其要求更少。")]),t._v(" "),e("p",[t._v("在这个例子中，让我们举一个Haswell Lake帧缓冲器，它通常用于桌面Haswell iGPU。"),e("code",[t._v("0x0D220003")]),t._v("("),e("code",[t._v("0300220D")]),t._v("当十六进制互换时)")]),t._v(" "),e("p",[t._v("现在让我们看看"),e("a",{attrs:{href:"https://github.com/acidanthera/WhateverGreen/blob/master/Manual/FAQ.IntelHD.en.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("WhateverGreen的手册"),e("OutboundLink")],1),t._v('中的相应信息(注意你需要点击 "Spoiler: Azul connectors")')]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 0D220003, STOLEN: 32 MB, FBMEM: 19 MB, VRAM: 1536 MB, Flags: 0x00000402\nTOTAL STOLEN: 52 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 116 MB, MAX OVERALL: 117 MB (123219968 bytes)\nCamellia: CamelliaDisabled (0), Freq: 5273 Hz, FreqMax: 5273 Hz\nMobile: 0, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x00000087 - ConnectorDP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x00000087 - ConnectorDP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x00000011 - ConnectorDP\n01050900 00040000 87000000\n02040A00 00040000 87000000\n03060800 00040000 11000000\n")])])]),e("p",[t._v("这里重要的是前两行。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 0D220003, STOLEN: 32 MB, FBMEM: 19 MB, VRAM: 1536 MB, Flags: 0x00000402\nTOTAL STOLEN: 52 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 116 MB, MAX OVERALL: 117 MB (123219968 bytes)\n")])])]),e("p",[t._v("这里是我们关心的主要条目。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Entry")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comment")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("STOLEN")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("32MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("保留给iGPU的内存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("FBMEM")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("19MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("为帧缓冲器保留的内存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("TOTAL CURSOR")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("1 MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("为游标保留的内存")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("TOTAL STOLEN")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("52 MB")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("以上的组合")])])])]),t._v(" "),e("p",[t._v("例如，你的主板只为iGPU分配了32MB的内存，这对于帧缓冲器所期望的来说太少了，所以当它试图写入一个不存在的内存区域时，很可能会出现内核崩溃。")]),t._v(" "),e("p",[t._v("这就是WhateverGreen的补丁功能的作用，在这里我们可以通过以下属性设置帧缓冲器所期望的iGPU内存的确切数量。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comment")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-patch-enable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这启用了WhateverGreen的补丁功能")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-stolenmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这设置了"),e("code",[t._v("STOLEN")]),t._v("条目所使用的值")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-fbmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这设置了"),e("code",[t._v("FBMEM")]),t._v("项使用的值")])])])]),t._v(" "),e("h2",{attrs:{id:"创建我们的补丁"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建我们的补丁"}},[t._v("#")]),t._v(" 创建我们的补丁")]),t._v(" "),e("p",[t._v("因此，为了降低这个VRAM要求，我们要把"),e("code",[t._v("STOLEN")]),t._v("设置为19MB，"),e("code",[t._v("FBMEM")]),t._v("设置为9MB。这将使我们低于32MB的限制。")]),t._v(" "),e("p",[t._v("要做到这一点，我们运行以下命令来覆盖9MB。")]),t._v(" "),e("div",{staticClass:"language-md extra-class"},[e("pre",{pre:!0,attrs:{class:"language-md"}},[e("code",[e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" 将9MB的兆字节转换成字节数")]),t._v("\necho '9 "),e("span",{pre:!0,attrs:{class:"token italic"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")]),e("span",{pre:!0,attrs:{class:"token content"}},[t._v(" 1024 ")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("*")])]),t._v(" 1024' | bc\n 9437184\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" 从十进制转换为十六进制")]),t._v("\necho 'obase=16; ibase=10; 9437184' | bc\n 900000\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" 十六进制交换，以便能够正确注入")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" 即成对地交换")]),t._v("\n900000 -> 90 00 00 -> 00 00 90\n\n"),e("span",{pre:!0,attrs:{class:"token title important"}},[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("#")]),t._v(" 将数值填充到4个字节，最后是00")]),t._v("\n00 00 90 00\n")])])]),e("p",[t._v("当我们对这两个值都这样做时，我们会得到:")]),t._v(" "),e("ul",[e("li",[t._v("19MB = "),e("code",[t._v("00 00 30 01")])]),t._v(" "),e("li",[t._v("9MB = "),e("code",[t._v("00 00 90 00")])])]),t._v(" "),e("p",[t._v("当我们把它打入我们的WhateverGreen属性时。")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Key")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Type")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-patch-enable")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("01000000")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-stolenmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("00003001")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("framebuffer-fbmem")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Data")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("00009000")])])])]),t._v(" "),e("ul",[e("li",[t._v("对于"),e("code",[t._v("patch-enable")]),t._v("，01000000只是指被启用。")])]),t._v(" "),e("h2",{attrs:{id:"应用我们的补丁"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#应用我们的补丁"}},[t._v("#")]),t._v(" 应用我们的补丁")]),t._v(" "),e("p",[t._v("现在我们打好了补丁，进入你的config.plist，然后在 "),e("code",[t._v("DeviceProperties -> Add -> PciRoot(0x0)/Pci(0x2,0x0)")]),t._v("下，添加属性。")]),t._v(" "),e("p",[e("img",{attrs:{src:a(300),alt:""}})])])}),[],!1,null,null,null);e.default=s.exports}}]);