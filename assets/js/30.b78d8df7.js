(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{296:function(t,e,a){t.exports=a.p+"assets/img/path-done.ceae32b9.png"},447:function(t,e,a){"use strict";a.r(e);var s=a(10),v=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"补丁总线id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#补丁总线id"}},[t._v("#")]),t._v(" 补丁总线ID")]),t._v(" "),e("p",[t._v("本节主要与那些无论连接器类型或SMBIOS补丁都无法使用某些显示输出的人有关，因为苹果对输出总线ID进行了硬编码，与你的硬件不匹配。为了解决这个问题，我们将手动修补这些总线ID以支持我们的硬件。")]),t._v(" "),e("p",[t._v("这一页会比较技术性，因为我们已经假定你已经读完了前面的几页，并且对WhateverGreen有了一定的了解。")]),t._v(" "),e("ul",[e("li",[e("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/connector.html"}},[t._v("修补显示类型")])],1),t._v(" "),e("li",[e("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/vram.html"}},[t._v("对macOS的VRAM要求进行修补")])],1)]),t._v(" "),e("h2",{attrs:{id:"解析帧缓冲区"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解析帧缓冲区"}},[t._v("#")]),t._v(" 解析帧缓冲区")]),t._v(" "),e("p",[t._v("首先，让我们假设我们使用的是一块带有UHD 630的Z390主板。这个系统在macOS中只使用iGPU，在使用某些显示输出时有问题，并且使用了"),e("code",[t._v("0x3E9B0007")]),t._v("帧缓冲器。")]),t._v(" "),e("p",[t._v("当我们从"),e("a",{attrs:{href:"https://github.com/acidanthera/WhateverGreen/blob/master/Manual/FAQ.IntelHD.en.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("WhateverGreen的手册"),e("OutboundLink")],1),t._v("上看这个帧缓冲器时，我们看到以下情况：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 3E9B0007, STOLEN: 57 MB, FBMEM: 0 bytes, VRAM: 1536 MB, Flags: 0x00801302\nTOTAL STOLEN: 58 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 172 MB, MAX OVERALL: 173 MB (181940224 bytes)\nGPU Name: Intel UHD Graphics 630\nModel Name(s):\nCamelia: Disabled\nMobile: 0, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),e("p",[t._v("现在让我们把它解析为BusID信息，因为这就是我们要修补的内容：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),e("p",[t._v("在这里，我们看到这个帧缓冲器的特性中列出了3个总线ID，让我们试着把它们分解，以便更容易理解。让我们来看看第1条：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n")])])]),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Bit")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Name")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Value")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Bit 1")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Port")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("01")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Bit 2")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Bus ID")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("05")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Bit 3-4")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Pipe Number")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("0900")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Bit 5-8")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Connector Type")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("00040000")])])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Bit 9-12")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Flags")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("code",[t._v("C7030000")])])])])]),t._v(" "),e("p",[t._v("需要记住的事情。")]),t._v(" "),e("ul",[e("li",[t._v("BusID是一个唯一的值，不能被多个条目使用")]),t._v(" "),e("li",[t._v("连接器类型的值与"),e("RouterLink",{attrs:{to:"/gpu-patching/intel-patching/connector.html"}},[t._v("连接器类型修补页")]),t._v("中讨论的相同。")],1)]),t._v(" "),e("h2",{attrs:{id:"映射视频端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#映射视频端口"}},[t._v("#")]),t._v(" 映射视频端口")]),t._v(" "),e("p",[t._v("这里我们有两个部分。")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#mapping-withinb-macos"}},[t._v("macOS内的映射")]),t._v(" "),e("ul",[e("li",[t._v("你可以启动macOS并使用至少一个显示器。")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"#mapping-without-macos"}},[t._v("不使用macOS的映射")]),t._v(" "),e("ul",[e("li",[t._v("在所有显示器上黑屏")])])])]),t._v(" "),e("h3",{attrs:{id:"在macos中的映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在macos中的映射"}},[t._v("#")]),t._v(" 在macOS中的映射")]),t._v(" "),e("p",[t._v("在macOS中映射视频是相当容易的，因为我们可以假设我们的一个端口在帧缓冲器中被正确映射。")]),t._v(" "),e("p",[t._v("在这个例子中，我们将解释常见的"),e("a",{attrs:{href:"https://sumingyd.github.io/OpenCore-Install-Guide/config-laptop.plist/kaby-lake.html#deviceproperties",target:"_blank",rel:"noopener noreferrer"}},[t._v("HDMI-hotplug fix for Kaby lake users"),e("OutboundLink")],1),t._v("。首先，让我们看一下"),e("code",[t._v("0x591B0000")]),t._v("帧缓冲区：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ID: 591B0000, STOLEN: 38 MB, FBMEM: 21 MB, VRAM: 1536 MB, Flags: 0x0000130B\nTOTAL STOLEN: 39 MB, TOTAL CURSOR: 1 MB (1572864 bytes), MAX STOLEN: 136 MB, MAX OVERALL: 137 MB (144191488 bytes)\nModel name: Intel HD Graphics KBL CRB\nCamellia: CamelliaDisabled (0), Freq: 1388 Hz, FreqMax: 1388 Hz\nMobile: 1, PipeCount: 3, PortCount: 3, FBMemoryCount: 3\n[0] busId: 0x00, pipe: 8, type: 0x00000002, flags: 0x00000098 - ConnectorLVDS\n[2] busId: 0x04, pipe: 10, type: 0x00000800, flags: 0x00000187 - ConnectorHDMI\n[3] busId: 0x06, pipe: 10, type: 0x00000400, flags: 0x00000187 - ConnectorDP\n00000800 02000000 98000000\n02040A00 00080000 87010000\n03060A00 00040000 87010000\n")])])]),e("p",[t._v("在这里，我们看到第2条是HDMI端口，但是在真正的Kaby lake笔记本电脑上，热插拔导致机器内核崩溃的情况非常普遍。这是由于总线ID和端口与硬件不完全一致造成的。")]),t._v(" "),e("p",[t._v("为了解决这个问题，我们要把它打成更合适的东西（即把"),e("code",[t._v("0204")]),t._v("改为 "),e("code",[t._v("0105")]),t._v("，这些都是经过测试可以正常工作的）。")]),t._v(" "),e("p",[t._v("有2种方法来修补。")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#replace-the-entire-entry"}},[t._v("替换整个条目")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#replace-sectons-of-the-entry"}},[t._v("替换条目的部分内容")])])]),t._v(" "),e("h4",{attrs:{id:"替换整个条目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#替换整个条目"}},[t._v("#")]),t._v(" 替换整个条目")]),t._v(" "),e("p",[t._v("要替换整个条目，我们首先要找到我们的条目，并确保它被正确枚举。这是因为Apple的条目从0开始，并依次递增。")]),t._v(" "),e("ul",[e("li",[t._v("con0")]),t._v(" "),e("li",[t._v("con1")]),t._v(" "),e("li",[t._v("con2")])]),t._v(" "),e("p",[t._v("因此，由于条目2是列表中的第二个，我们要使用con1。")]),t._v(" "),e("ul",[e("li",[t._v("framebuffer-con2-enable")])]),t._v(" "),e("p",[t._v("接下来让我们打补丁，我们知道端口需要打成"),e("code",[t._v("01")]),t._v("，BusID改成"),e("code",[t._v("05")]),t._v(":")]),t._v(" "),e("ul",[e("li",[e("code",[e("strong",[t._v("0105")]),t._v("0A00 00080000 87010000")])])]),t._v(" "),e("p",[t._v("最后，我们得到了以下补丁。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con2-alldata | Data | `01050A00 00080000 87010000`\n")])])]),e("h4",{attrs:{id:"替换条目的各个部分"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#替换条目的各个部分"}},[t._v("#")]),t._v(" 替换条目的各个部分")]),t._v(" "),e("p",[t._v("要替换条目的某些部分，我们首先要找到我们的条目，并确保它被正确列举出来。这是因为苹果公司的条目从0开始，然后依次递增。")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("con0")])]),t._v(" "),e("li",[e("code",[t._v("con1")])]),t._v(" "),e("li",[e("code",[t._v("con2")])])]),t._v(" "),e("p",[t._v("因此，由于条目2是列表中的第二个，我们要使用con1。")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("framebuffer-con1-enable")]),t._v("。")])]),t._v(" "),e("p",[t._v("接下来让我们打补丁，我们知道端口需要打成01，BusID改成05。")]),t._v(" "),e("ul",[e("li",[t._v("framebuffer-con2-index = "),e("code",[t._v("01")])]),t._v(" "),e("li",[t._v("framebuffer-con2-busid = "),e("code",[t._v("05")])])]),t._v(" "),e("p",[t._v("最后，我们得到了这些补丁:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con2-index   | Data | `01`\nframebuffer-con2-busid   | Data | `05`\n")])])]),e("h3",{attrs:{id:"没有macos的映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#没有macos的映射"}},[t._v("#")]),t._v(" 没有macOS的映射")]),t._v(" "),e("p",[t._v("映射你的显示器输出是相当简单的，"),e("em",[t._v("然而")]),t._v("是相当耗时的，因为你需要尝试每一个BusID值，直到你得到一个输出。")]),t._v(" "),e("p",[t._v("在这个例子中，我们将再次使用0x3E9B0007帧缓冲器。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("[1] busId: 0x05, pipe: 9, type: 0x00000400, flags: 0x000003C7 - DP\n[2] busId: 0x04, pipe: 10, type: 0x00000400, flags: 0x000003C7 - DP\n[3] busId: 0x06, pipe: 8, type: 0x00000400, flags: 0x000003C7 - DP\n01050900 00040000 C7030000\n02040A00 00040000 C7030000\n03060800 00040000 C7030000\n")])])]),e("p",[t._v("首先，我们将试图通过条目1的BusIDs，希望能找到工作值。")]),t._v(" "),e("h5",{attrs:{id:"_1-在这里插上你的hdmi显示器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-在这里插上你的hdmi显示器"}},[t._v("#")]),t._v(" 1. 在这里插上你的HDMI显示器")]),t._v(" "),e("h5",{attrs:{id:"_2-将端口1设置为hdmi连接器类型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-将端口1设置为hdmi连接器类型"}},[t._v("#")]),t._v(" 2. 将端口1设置为HDMI连接器类型")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("01xx0900 "),e("strong",[t._v("00080000")]),t._v(" C7030000")])])]),t._v(" "),e("details",{staticClass:"custom-block details"},[e("summary",[t._v("支持的连接器类型")]),t._v(" "),e("p",[t._v("macOS中支持的常见连接器类型")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<02 00 00 00>        LVDS 和 eDP      - 笔记本显示器\n<10 00 00 00>        VGA               - 在10.8和更新的版本中不被支持\n<00 04 00 00>        DisplayPort       - USB-C显示输出内部为DP\n<01 00 00 00>        DUMMY             - 在没有物理端口时使用\n<00 08 00 00>        HDMI\n<80 00 00 00>        S-Video\n<04 00 00 00>        DVI (双链路)\n<00 02 00 00>        DVI (单链路)\n")])])]),e("p",[t._v("提醒大家，Skylake和更新版本的VGA在内部实际上是DisplayPort，所以用这种连接器类型代替。")])]),t._v(" "),e("h5",{attrs:{id:"_3-用busid-00禁用端口2和3"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-用busid-00禁用端口2和3"}},[t._v("#")]),t._v(" 3. 用busid=00禁用端口2和3")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("02"),e("strong",[t._v("00")]),t._v("0A00 00040000 C7030000")])]),t._v(" "),e("li",[e("code",[t._v("03"),e("strong",[t._v("00")]),t._v("0800 00040000 C7030000")])])]),t._v(" "),e("h5",{attrs:{id:"_4-如果前面的方法不奏效-就走一遍端口1的busids。在大多数平台上-最大的busid一般是0x06"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-如果前面的方法不奏效-就走一遍端口1的busids。在大多数平台上-最大的busid一般是0x06"}},[t._v("#")]),t._v(" 4. 如果前面的方法不奏效，就走一遍端口1的busids。在大多数平台上，最大的busid一般是0x06")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("01"),e("strong",[t._v("01")]),t._v("0900 00080000 C7030000")])]),t._v(" "),e("li",[e("code",[t._v("01"),e("strong",[t._v("02")]),t._v("0900 00080000 C7030000")])]),t._v(" "),e("li",[e("code",[t._v("01"),e("strong",[t._v("03")]),t._v("0900 00080000 C7030000")])]),t._v(" "),e("li",[t._v("等")])]),t._v(" "),e("p",[t._v("如果还是没有输出，把端口1的母线设置为00，然后开始查看端口2的母线，依次类推。")]),t._v(" "),e("ul",[e("li",[t._v("port 1 = "),e("code",[t._v("01000900 00040000 C7030000")])]),t._v(" "),e("li",[t._v("port 2 = "),e("code",[t._v("02"),e("strong",[t._v("xx")]),t._v("0A00 00080000 C7030000")])]),t._v(" "),e("li",[t._v("port 3 = "),e("code",[t._v("03000800 00040000 C7030000")])])]),t._v(" "),e("h4",{attrs:{id:"添加到你的config-plist中"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加到你的config-plist中"}},[t._v("#")]),t._v(" 添加到你的config.plist中")]),t._v(" "),e("p",[t._v("你现在要在 "),e("code",[t._v("DeviceProperteies -> Add -> PciRoot(0x0)/Pci(0x2,0x0)")]),t._v("中添加以下补丁:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("framebuffer-patch-enable | Data | `01000000`\nframebuffer-con0-enable  | Data | `01000000`\nframebuffer-con1-enable  | Data | `01000000`\nframebuffer-con2-enable  | Data | `01000000`\nframebuffer-con0-alldata | Data | port 1 (ie. `01010900 00080000 C7030000`)\nframebuffer-con1-alldata | Data | port 2 (ie. `02000A00 00040000 C7030000`)\nframebuffer-con2-alldata | Data | port 3 (ie. `03000800 00040000 C7030000`)\n")])])]),e("p",[t._v("请注意:")]),t._v(" "),e("ul",[e("li",[t._v("端口1将被标记为"),e("code",[t._v("con0")])]),t._v(" "),e("li",[t._v("端口1的BusID被设置为`01'")]),t._v(" "),e("li",[t._v("端口2和3的BusID被设置为`00'，禁用它们")])]),t._v(" "),e("p",[t._v("完成后，你应该得到类似的东西:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(296),alt:""}})]),t._v(" "),e("p",[t._v("如前所述，如果这个组合不起作用，就增加端口1的BusID，如果还不起作用，就禁用端口1的BusID，然后尝试端口2，以此类推。")])])}),[],!1,null,null,null);e.default=v.exports}}]);