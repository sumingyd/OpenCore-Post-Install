(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{396:function(t,e,a){t.exports=a.p+"assets/img/initial-boot.6a3eae3f.png"},397:function(t,e,a){t.exports=a.p+"assets/img/front-io-plugged.7e34db4c.png"},398:function(t,e,a){t.exports=a.p+"assets/img/usb-c-test.6e512b44.png"},399:function(t,e,a){t.exports=a.p+"assets/img/usb-a-test-3.8ad1d384.png"},400:function(t,e,a){t.exports=a.p+"assets/img/usb-a-test-4.a06acca3.png"},401:function(t,e,a){t.exports=a.p+"assets/img/usb-a-test-2.0d237546.png"},402:function(t,e,a){t.exports=a.p+"assets/img/location-id.0e09ce14.png"},403:function(t,e,a){t.exports=a.p+"assets/img/front-io-diagram.6debd359.png"},404:function(t,e,a){t.exports=a.p+"assets/img/full-diagram-port.95a0acd7.png"},405:function(t,e,a){t.exports=a.p+"assets/img/usb-c-test-2.ac6df531.png"},406:function(t,e,a){t.exports=a.p+"assets/img/full-diagram.df6685c2.png"},407:function(t,e,a){t.exports=a.p+"assets/img/bluetooth.cb166ecb.png"},408:function(t,e,a){t.exports=a.p+"assets/img/usr.f0bf7e0c.png"},409:function(t,e,a){t.exports=a.p+"assets/img/ssdt-rhub-normal.ae4515de.png"},410:function(t,e,a){t.exports=a.p+"assets/img/ssdt-rhub.c870313a.png"},411:function(t,e,a){t.exports=a.p+"assets/img/ssdt-rhub-fixed.c60433a7.png"},412:function(t,e,a){t.exports=a.p+"assets/img/ssdt-save.7aca1f0e.png"},413:function(t,e,a){t.exports=a.p+"assets/img/show-contents.6e2ee797.png"},414:function(t,e,a){t.exports=a.p+"assets/img/info-plist.4270a49f.png"},415:function(t,e,a){t.exports=a.p+"assets/img/info-plist-open.878e50dc.png"},416:function(t,e,a){t.exports=a.p+"assets/img/rp05-entry.d5f3ffba.png"},417:function(t,e,a){t.exports=a.p+"assets/img/iopath-match.94411b7c.png"},418:function(t,e,a){t.exports=a.p+"assets/img/ioproviderclass.106aee58.png"},419:function(t,e,a){t.exports=a.p+"assets/img/iorpoviderclass-plist.1849a764.png"},420:function(t,e,a){t.exports=a.p+"assets/img/smbios.dd36131c.png"},421:function(t,e,a){t.exports=a.p+"assets/img/smbios-plist.bb87baef.png"},422:function(t,e,a){t.exports=a.p+"assets/img/ioprovidermerge.23b33fb1.png"},423:function(t,e,a){t.exports=a.p+"assets/img/name.abed48f7.png"},424:function(t,e,a){t.exports=a.p+"assets/img/port.fe3f2983.png"},425:function(t,e,a){t.exports=a.p+"assets/img/port-plist.5263aa29.png"},426:function(t,e,a){t.exports=a.p+"assets/img/port-count.c2ba2fe1.png"},427:function(t,e,a){t.exports=a.p+"assets/img/finished.c7d11f9e.png"},476:function(t,e,a){"use strict";a.r(e);var v=a(10),s=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"usb映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usb映射"}},[t._v("#")]),t._v(" USB映射")]),t._v(" "),e("p",[t._v("因此，有了先决条件，我们终于可以开始这篇指南的核心内容了。现在我们终于可以在每晚睡觉前读一本我最喜欢的书:"),e("a",{attrs:{href:"https://uefi.org/specs/ACPI/6.4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("高级配置和电源接口(ACPI)规范!"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("现在，如果你之前没有读过这篇文章(我强烈建议你读，这是一个激动人心的故事)，我将向你指出USB的主要情况:")]),t._v(" "),e("ul",[e("li",[t._v("第9.14节:_UPC (USB端口能力)")])]),t._v(" "),e("p",[t._v("在这里，我们可以看到ACPI中所有可能的USB端口:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("信息")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB 2.0 Type-A连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这是macOS在没有映射时默认的所有端口")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB 3.0 Type-A连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("3.0、3.1和3.2端口共享相同的类型")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("8")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - 仅支持USB 2.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("主要用于手机")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("9")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0和开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("翻转设备"),e("strong",[t._v("不会")]),t._v("改变ACPI端口")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0无开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("翻转设备"),e("strong",[t._v("会")]),t._v("改变ACPI端口。一般见于3.1/2主板头")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("255")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("专用连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用于内部USB端口，如蓝牙")])])])]),t._v(" "),e("h2",{attrs:{id:"usb映射-手动方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usb映射-手动方式"}},[t._v("#")]),t._v(" USB映射:手动方式")]),t._v(" "),e("p",[t._v("本节是为那些想深入了解黑苹果的人准备的，他们可以真正了解它在做什么，并在USBmap.py和其他映射工具有任何问题时提供帮助。首先，我们需要一些东西:")]),t._v(" "),e("ul",[e("li",[t._v("macOS的安装版本\n"),e("ul",[e("li",[t._v("这是由于macOS枚举端口的方式，试图从其他操作系统映射会使这变得困难")]),t._v(" "),e("li",[t._v("注:本指南将集中在OS X 10.11, El Capitan和更新。旧的操作系统不需要任何USB映射")])])]),t._v(" "),e("li",[t._v("无冲突的USB名称\n"),e("ul",[e("li",[t._v("请参阅上一节:"),e("RouterLink",{attrs:{to:"/usb/system-preparation.html#checking-what-renames-you-need"}},[t._v("检查你需要的重命名")])],1)])]),t._v(" "),e("li",[t._v("用于测试的USB 2.0和USB 3.0设备\n"),e("ul",[e("li",[t._v("你必须有两个独立的设备，以确保映射的时候系统不会混淆")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-302.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("IORegistryExplorer.app"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("更容易查看macOS的内部工作原理")]),t._v(" "),e("li",[t._v("如果您计划使用Discord进行故障排除，"),e("a",{attrs:{href:"https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-210.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("v2.1.0"),e("OutboundLink")],1),t._v("在文件大小上分辨会更容易一些。")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://bitbucket.org/RehabMan/os-x-usb-inject-all/downloads/",target:"_blank",rel:"noopener noreferrer"}},[t._v("USBInjectAll"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("这在较旧的USB控制器才需要，如Broadwell和更旧的，但是一些Coffee Lake系统可能仍然需要它")]),t._v(" "),e("li",[e("strong",[t._v("提示")]),t._v("这个kext不能在AMD上工作")])])]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/dortania/OpenCore-Post-Install/blob/master/extra-files/Sample-USB-Map.kext.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sample-USB-Map.kext"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://github.com/corpnewt/ProperTree",target:"_blank",rel:"noopener noreferrer"}},[t._v("ProperTree"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("或任何其他plist编辑器")])])])]),t._v(" "),e("p",[t._v("现在，所有这些都解决了，让我们进入USB映射!")]),t._v(" "),e("h2",{attrs:{id:"找到你的usb端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#找到你的usb端口"}},[t._v("#")]),t._v(" 找到你的USB端口")]),t._v(" "),e("p",[t._v("让我们打开之前下载的"),e("a",{attrs:{href:"https://github.com/khronokernel/IORegistryClone/blob/master/ioreg-302.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("IORegistryExplorer.app"),e("OutboundLink")],1),t._v("并搜索我们的USB控制器。")]),t._v(" "),e("p",[t._v("两个主要的搜索词是 "),e("code",[t._v("XHC")]),t._v(" 和 "),e("code",[t._v("EHC")]),t._v(", 但如果你有一个带有UHCI或OHCI控制器的 legacy 板，你就需要调整。一个笼统的 "),e("code",[t._v("USB")]),t._v(" 搜索可能会显示太多的条目，让你感到困惑。")]),t._v(" "),e("p",[t._v("对于这个例子，让我们尝试映射华硕X299-E Strix主板:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(396),alt:""}})]),t._v(" "),e("p",[t._v("从上图中我们可以看到3个USB控制器:")]),t._v(" "),e("ul",[e("li",[t._v("PXSX(1, 上)")]),t._v(" "),e("li",[t._v("PXSX(2, 中)")]),t._v(" "),e("li",[t._v("XHCI(3, 下)")])]),t._v(" "),e("p",[t._v("请注意，它们是独立的控制器，因为这意味着"),e("strong",[t._v("每个USB控制器都有自己的端口限制")]),t._v("。所以你并不像你想的那样渴望USB端口。")]),t._v(" "),e("p",[t._v("现在我个人知道哪个USB控制器匹配哪个物理端口，问题是它并不总是那么明显的哪个端口匹配哪个控制器。所以我们试着找出哪个是什么。")]),t._v(" "),e("p",[e("strong",[t._v("注意")]),t._v(":AppleUSBLegacyRoot项列出了所有活动的USB控制器和端口，这些不是USB控制器本身，所以你可以直接忽略它们。")]),t._v(" "),e("p",[e("strong",[t._v("注2")]),t._v(":请记住，每个主板型号都有一组独特的端口组合、控制器类型和名称。因此，虽然我们的示例使用PXSX，但您的示例可能有XHC0或PTCP名称。在较老的主板上很常见的是，你可能只有一个控制器，这是好的，所以不要强调和例子有完全相同的设置。")]),t._v(" "),e("p",[t._v("你可以查看常用的名称:")]),t._v(" "),e("ul",[e("li",[t._v("USB 3.x 控制器:\n"),e("ul",[e("li",[t._v("XHC")]),t._v(" "),e("li",[t._v("XHC0")]),t._v(" "),e("li",[t._v("XHC1")]),t._v(" "),e("li",[t._v("XHC2")]),t._v(" "),e("li",[t._v("XHCI")]),t._v(" "),e("li",[t._v("XHCX")]),t._v(" "),e("li",[t._v("AS43")]),t._v(" "),e("li",[t._v("PTXH\n"),e("ul",[e("li",[t._v("通常与AMD芯片组控制器相关")])])]),t._v(" "),e("li",[t._v("PTCP\n"),e("ul",[e("li",[t._v("在AsRock X399上找到")])])]),t._v(" "),e("li",[t._v("PXSX\n"),e("ul",[e("li",[t._v("这是一个通用的PCIe设备，"),e("strong",[t._v("仔细检查它是否是USB设备")]),t._v("，因为NVMe控制器和其他设备可以使用相同的名称。")])])])])]),t._v(" "),e("li",[t._v("USB 2.x 控制器:\n"),e("ul",[e("li",[t._v("EHCI")]),t._v(" "),e("li",[t._v("EHC1")]),t._v(" "),e("li",[t._v("EHC2")]),t._v(" "),e("li",[t._v("EUSB")]),t._v(" "),e("li",[t._v("USBE")])])])]),t._v(" "),e("h3",{attrs:{id:"找出哪个端口与哪个控制器匹配"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#找出哪个端口与哪个控制器匹配"}},[t._v("#")]),t._v(" 找出哪个端口与哪个控制器匹配")]),t._v(" "),e("p",[t._v("首先，我要把一个USB设备插入我的USB 3.1(a型)和USB 3.2(c型):")]),t._v(" "),e("p",[e("img",{attrs:{src:a(397),alt:""}})]),t._v(" "),e("p",[t._v("接下来让我们看看IOReg，我们可以看到我们的USB设备出现在哪里:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("USB-C")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("USB-A")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(398),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(399),alt:""}})])])])]),t._v(" "),e("p",[t._v("在这里我们看到了一些东西:")]),t._v(" "),e("ul",[e("li",[t._v("前3.2类型-c在PXSX(2，中间)控制器上")]),t._v(" "),e("li",[t._v("前3.1类型-a在XHCI(3，底部)控制器上")])]),t._v(" "),e("p",[t._v("现在我们已经知道了哪个端口连接到哪个控制器，现在可以看看我们如何映射USB了。")]),t._v(" "),e("h3",{attrs:{id:"usb-a-映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usb-a-映射"}},[t._v("#")]),t._v(" USB-A 映射")]),t._v(" "),e("p",[t._v("如前所述，usb3.x端口分为两种类型:usb2.0和usb3.0。这是为了确保向后兼容，但macOS本身很难确定哪些特型与哪些端口匹配。这就是我们要提供帮助的地方。")]),t._v(" "),e("p",[t._v("所以让我们使用USB-a端口，当我们将USB 3.0设备插入它时，我们看到"),e("code",[t._v("XHCI -> SS03")]),t._v("亮起。这是端口的USB 3.0特性。现在我们要在该端口上插入USB 2.0设备:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("3.0 特型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("2.0 特型")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(400),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(401),alt:""}})])])])]),t._v(" "),e("p",[t._v("我们看到我们的3.0端口的USB 2.0特性是"),e("code",[t._v("XHCI -> HS03")]),t._v("，现在你应该能够了解我们试图做什么:")]),t._v(" "),e("ul",[e("li",[t._v("正面a型:\n"),e("ul",[e("li",[t._v("HS03: 2.0特型")]),t._v(" "),e("li",[t._v("SS03: 3.0特型")])])])]),t._v(" "),e("p",[e("strong",[t._v("注意")]),t._v(":如果你的USB端口显示为AppleUSB20XHCIPort或AppleUSB30XHCIPort，你仍然可以映射，但是会有点困难。与其把名字写下来，不如密切关注右边的"),e("code",[t._v("port")]),t._v("属性:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(402),alt:""}})]),t._v(" "),e("h3",{attrs:{id:"创建个人地图"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建个人地图"}},[t._v("#")]),t._v(" 创建个人地图")]),t._v(" "),e("p",[t._v("这就是我们拿出笔和纸，开始写下哪个端口与哪个数字端口相匹配的地方。你的地图可能看起来像这样的一个例子:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("名称映射")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("属性映射")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(403),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(404),alt:""}})])])])]),t._v(" "),e("p",[t._v("你自己的地图不需要完全像这样，但是你需要一些你很容易理解和参考的东西。")]),t._v(" "),e("p",[t._v("注意:")]),t._v(" "),e("ul",[e("li",[t._v("名称映射:当一个正确的名称在IOReg中显示时(例如:HS01)")]),t._v(" "),e("li",[t._v("属性映射:当没有给出合适的名称时(例如:AppleUSB30XHCIPort）")])]),t._v(" "),e("h3",{attrs:{id:"usb-c映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usb-c映射"}},[t._v("#")]),t._v(" USB-C映射")]),t._v(" "),e("p",[t._v("接下来映射我们的USB-C端口，这是非常棘手的地方，你可能已经注意到了:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("类型")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("信息")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("8")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - 仅支持USB 2.0的")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("主要见于手机")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("9")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0带开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("翻动设备"),e("strong",[t._v("不")]),t._v("改变ACPI接口")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0没有开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}}),t._v(" "),e("td",[t._v("翻转设备"),e("strong",[t._v("会")]),t._v("改变ACPI接口。一般见于3.1/2主板头")])])])]),t._v(" "),e("p",[t._v("所以当我们映射我们的USB-C头时，我们注意到它占用了SS01端口。但当我们翻转它时，我们实际上是在SS02端口上填充它。当发生这种情况时，你需要在应用端口类型时将其记录下来。")]),t._v(" "),e("ul",[e("li",[t._v("注意:该端口的所有特型将被置于10型之下")]),t._v(" "),e("li",[t._v("注意2:并非所有USB-C表头都是10，"),e("strong",[t._v("仔细检查你的表头")])])]),t._v(" "),e("p",[e("img",{attrs:{src:a(405),alt:""}})]),t._v(" "),e("h3",{attrs:{id:"继续映射"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#继续映射"}},[t._v("#")]),t._v(" 继续映射")]),t._v(" "),e("p",[t._v("现在您已经有了基本的想法，您将需要到处查看每个USB端口并将其映射出来。这需要时间，别忘了把它写下来。最终的图表应该类似于下面这样:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(406),alt:""}})]),t._v(" "),e("h3",{attrs:{id:"special-notes"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#special-notes"}},[t._v("#")]),t._v(" Special Notes")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#bluetooth"}},[t._v("蓝牙")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#usrx-ports"}},[t._v("USRx端口")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#missing-usb-ports"}},[t._v("没有 USB 端口")])])]),t._v(" "),e("h4",{attrs:{id:"蓝牙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#蓝牙"}},[t._v("#")]),t._v(" 蓝牙")]),t._v(" "),e("p",[t._v("所以，虽然对很多人来说并不明显，但蓝牙实际上是在内部通过USB接口运行的。这意味着在映射时，你需要密切关注IOReg中已经显示的设备:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(407),alt:""}})]),t._v(" "),e("p",[t._v("请记住这一点，因为这是255类型，并使某些服务(如切换)正常工作。")]),t._v(" "),e("h4",{attrs:{id:"usrx端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#usrx端口"}},[t._v("#")]),t._v(" USRx端口")]),t._v(" "),e("p",[t._v("在映射时，您可能会注意到一些剩余的端口，特别是USR1和USR2。这些端口被称为“USBR”端口，或者更具体地说是"),e("a",{attrs:{href:"https://software.Intel.com/content/www/us/en/develop/documentation/amt-developer-guide/top/storage-redirection.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("USB重定向端口"),e("OutboundLink")],1),t._v(".使用这些设备是为了进行远程管理，但真正的mac没有附带USBR设备，所以在操作系统方面没有对它们的支持。实际上，你可以忽略USB映射表中的这些条目:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(408),alt:""}})]),t._v(" "),e("h4",{attrs:{id:"缺少usb接口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缺少usb接口"}},[t._v("#")]),t._v(" 缺少USB接口")]),t._v(" "),e("p",[t._v("在一些罕见的情况下，某些USB端口可能根本不显示在macOS中。这可能是由于您的ACPI表中缺少定义，因此我们有几个选择:")]),t._v(" "),e("ul",[e("li",[t._v("Coffee Lake 及以上应使用 "),e("a",{attrs:{href:"https://github.com/Sniki/OS-X-USB-Inject-All/releases",target:"_blank",rel:"noopener noreferrer"}},[t._v("USBInjectAll"),e("OutboundLink")],1),t._v(" "),e("ul",[e("li",[t._v("不要忘记添加到 EFI/OC/Kexts 和你的 config.plist's kernel -> Add中")])])]),t._v(" "),e("li",[t._v("Comet Lake和更新版本应该使用SSDT-RHUB")]),t._v(" "),e("li",[t._v("AMD系统也应该使用SSDT-RHUB")])]),t._v(" "),e("p",[t._v("SSDT-RHUB的目的是重置你的USB控制器，并强制macOS重新枚举它们。这避免了为现有的ACPI表打补丁的麻烦。")]),t._v(" "),e("p",[t._v("创建自己的SSDT-RHUB-MAP:")]),t._v(" "),e("ul",[e("li",[t._v("获取SSDT副本: "),e("a",{attrs:{href:"https://github.com/dortania/Getting-Started-With-ACPI/blob/master/extra-files/decompiled/SSDT-RHUB.dsl",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSDT-RHUB.dsl"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("获取 "),e("a",{attrs:{href:"https://github.com/acidanthera/MaciASL/releases/tag/1.5.7",target:"_blank",rel:"noopener noreferrer"}},[t._v("maciASL"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("接下来，用maciASL打开我们新下载的SSDT，你应该会看到以下内容:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(409),alt:""}})]),t._v(" "),e("p",[t._v("现在，打开IOReg并找到你想要重置的USB控制器(注意，它是USB控制器，而不是同名的子RHUB):")]),t._v(" "),e("p",[t._v("如果你看右边，你应该会看到"),e("code",[t._v("acpi-apth")]),t._v("属性。这里我们需要把它翻译成我们的SSDT可以使用的东西:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改前")]),t._v("\nIOService:/AppleACPIPlatformExpert/PC00@0/AppleACPIPCI/RP05@1C,4/IOPP/PXSX@0\n")])])]),e("p",[t._v("现在我们要去掉所有不必要的数据:")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("IOService:/AppleACPIPlatformExpert/")])]),t._v(" "),e("li",[e("code",[t._v("@##")])]),t._v(" "),e("li",[e("code",[t._v("IOPP")])])]),t._v(" "),e("p",[t._v("一旦清理干净，你的应该看起来类似:")]),t._v(" "),e("div",{staticClass:"language-sh extra-class"},[e("pre",{pre:!0,attrs:{class:"language-sh"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改后")]),t._v("\nPC00.RP05.PXSX\n")])])]),e("p",[t._v("按照上面的例子，我们将 "),e("code",[t._v("PCI0.XHC1.RHUB")]),t._v(" 重命名为 "),e("code",[t._v("PC00.RP05.PXSX.RHUB")]),t._v(":")]),t._v(" "),e("p",[e("strong",[t._v("之前")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("External (_SB_.PCI0.XHC1.RHUB, DeviceObj) <- 重命名\n\nScope (_SB.PCI0.XHC1.RHUB) <- 重命名\n")])])]),e("p",[e("img",{attrs:{src:a(410),alt:""}})]),t._v(" "),e("p",[t._v("按照我们找到的示例路径，SSDT应该看起来像这样:")]),t._v(" "),e("p",[e("strong",[t._v("之后")]),t._v(":")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("External (_SB.PC00.RP05.PXSX.RHUB, DeviceObj) <- 重命名\n\nScope (_SB.PC00.RP05.PXSX.RHUB) <- 重命名\n")])])]),e("p",[e("img",{attrs:{src:a(411),alt:""}})]),t._v(" "),e("p",[t._v("一旦你将SSDT编辑到USB控制器的路径下，你就可以使用"),e("code",[t._v("File -> SaveAs -> ACPI Machine Language Binary")]),t._v("将其导出:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(412),alt:""}})]),t._v(" "),e("p",[t._v("最后，请记住将此SSDT添加到 EFI/OC/ACPI 和你 config.plist 中的 ACPI -> Add.")]),t._v(" "),e("h2",{attrs:{id:"创建kext"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建kext"}},[t._v("#")]),t._v(" 创建kext")]),t._v(" "),e("p",[t._v("大家期待已久的时间到了，我们终于可以创建我们的USB map了!")]),t._v(" "),e("p",[t._v("首先，我们需要获取一个USB map kext示例:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://github.com/dortania/OpenCore-Post-Install/blob/master/extra-files/Sample-USB-Map.kext.zip",target:"_blank",rel:"noopener noreferrer"}},[t._v("Sample-USB-Map.kext"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("接下来右键单击.kext，并选择“显示包内容”。然后深入到info.plist:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("显示内容")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("info.plist")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(413),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(414),alt:""}})])])])]),t._v(" "),e("p",[t._v("现在让我们打开ProperTree，看看这个info.plist:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(415),alt:""}})]),t._v(" "),e("p",[t._v("下面我们看到在"),e("code",[t._v("iokitpersonality")]),t._v("下的几个部分:")]),t._v(" "),e("ul",[e("li",[t._v("RP05 - PXSX(1)")]),t._v(" "),e("li",[t._v("RP07 - PXSX(2)")]),t._v(" "),e("li",[t._v("XHCI - XHCI")])]),t._v(" "),e("p",[t._v("这里的每个条目表示一个USB控制器，特别是每个控制器的映射。然而，条目的名称并不重要，它更重要的是为了好记，以便您知道哪个条目有哪个USB映射。")]),t._v(" "),e("p",[t._v("接下来让我们进入"),e("code",[t._v("RP05 - PXSX(1)")]),t._v("条目:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(416),alt:""}})]),t._v(" "),e("p",[t._v("这里我们看到了一些更重要的属性:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Property")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comment")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("IOPathMatch")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("macOS将选择将map附加到该设备")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("IOProviderClass")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("macOS将选择附加的USB驱动程序")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("model")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB映射也连接了SMBIOS")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("IOProviderMergeProperties")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("保存实际端口映射的字典")])])])]),t._v(" "),e("h3",{attrs:{id:"determining-the-properties"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#determining-the-properties"}},[t._v("#")]),t._v(" Determining the properties")]),t._v(" "),e("p",[t._v("Determining the value for each property is actually quite straight forward:")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"#iopathmatch"}},[t._v("IOPathMatch")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#ioproviderclass"}},[t._v("IOProviderClass")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#model"}},[t._v("model")])]),t._v(" "),e("li",[e("a",{attrs:{href:"#ioprovidermergeproperties"}},[t._v("IOProviderMergeProperties")])])]),t._v(" "),e("h4",{attrs:{id:"iopathmatch"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#iopathmatch"}},[t._v("#")]),t._v(" IOPathMatch")]),t._v(" "),e("p",[t._v("找到IOPathMatch非常简单，首先找到你想要映射的USB控制器，然后选择根集线器(所以PXSX子集线器与父集线器同名，不要担心，当你查看图像时，它会减少困惑):")]),t._v(" "),e("p",[e("img",{attrs:{src:a(417),alt:""}})]),t._v(" "),e("p",[t._v("现在选择PXSX条目，简单地复制(Cmd+C)并粘贴到我们的info.plist。你的属性应该如下图所示:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("IOService:/AppleACPIPlatformExpert/PC00@0/AppleACPIPCI/RP05@1C,4/IOPP/PXSX@0/PXSX@01000000\n")])])]),e("p",[e("strong",[t._v("注意")]),t._v(":每个USB控制器都有一个唯一的IOPathMatch值，如果你有多个同名控制器，请记住这一点。这款Asus X299板有2个PXSX USB控制器，因此每个新的USB map字典将有一个唯一的IOPathMatch条目。")]),t._v(" "),e("h4",{attrs:{id:"ioproviderclass"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ioproviderclass"}},[t._v("#")]),t._v(" IOProviderClass")]),t._v(" "),e("p",[t._v("查找IOProviderClass也很简单，再次选择Root-hub并查找CFBundleIdentifier值:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("IOReg")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("info.plist")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(418),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(419),alt:""}})])])])]),t._v(" "),e("p",[t._v("现在我们不能把这个值设为1-1，而是需要将Kext的短名称改为"),e("code",[t._v("AppleUSBXHCIPCI")]),t._v("(因此我们删除了"),e("code",[t._v("com.apple.driver.usb.")]),t._v(")。")]),t._v(" "),e("h4",{attrs:{id:"model"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#model"}},[t._v("#")]),t._v(" model")]),t._v(" "),e("p",[t._v("如果你忘记了你正在使用的SMBIOS，你可以在IOReg中检查顶级设备:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("IOReg")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("info.plist")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(420),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(421),alt:""}})])])])]),t._v(" "),e("h3",{attrs:{id:"ioprovidermergeproperties"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ioprovidermergeproperties"}},[t._v("#")]),t._v(" IOProviderMergeProperties")]),t._v(" "),e("p",[t._v("现在让我们打开IOProviderMergeProperties字典:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(422),alt:""}})]),t._v(" "),e("p",[t._v("这里我们有很多数据要处理:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("属性")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("说明")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("name")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB端口的字典名称")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("port-count")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这是要注入的最大端口值")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("UsbConnector")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这是ACPI 9.14节中提到的USB端口类型")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("port")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("您的USB端口在ACPI中的物理位置")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("Comment")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("一个可选的条目，帮助您备注端口")])])])]),t._v(" "),e("p",[t._v("And a reminder of all possible port types:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("Type")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Info")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("Comments")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB 2.0 Type-A连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("这是macOS在没有映射时默认的所有端口")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("3")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("USB 3.0 Type-A连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("3.0、3.1和3.2端口共享相同的类型")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("8")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - 仅支持USB 2.0")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("主要出现在手机上")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("9")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0带开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("翻转设备"),e("strong",[t._v("不会")]),t._v("改变ACPI端口")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("10")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("Type C连接器 - USB 2.0和USB 3.0不带开关")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("翻转设备"),e("strong",[t._v("会")]),t._v("改变ACPI端口。通常可以在3.1/2主板标头上看到")])]),t._v(" "),e("tr",[e("td",{staticStyle:{"text-align":"left"}},[t._v("255")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("专用连接器")]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[t._v("用于内部USB端口，如蓝牙")])])])]),t._v(" "),e("p",[t._v("现在应该回到原点了，你可以看到我们之前映射端口的工作方式。")]),t._v(" "),e("h4",{attrs:{id:"name"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#name"}},[t._v("#")]),t._v(" name")]),t._v(" "),e("p",[t._v("name属性实际上是USB端口字典的名称，仅用于内部维护。记住，你想使用的每个USB端口都需要有自己独特的USB端口字典。")]),t._v(" "),e("p",[t._v("除了显示在IOReg中，名称本身没有任何值，所以这可以是你喜欢的任何值。为了保持正常，我们使用ACPI表已经给出的名称(在本例中是HS01)，但名称可以是任何4个字符的条目。但是不要超过这4字符限制,会发生意想不到的副作用。")]),t._v(" "),e("ul",[e("li",[t._v("注意:那些带有AppleUSB20XHCIPort或AppleUSB30XHCIPort名称的USB端口，你应该选择一个易于识别的名称。在英特尔，这是HSxx为2.0特型，SSxx为3.0特型")])]),t._v(" "),e("p",[e("img",{attrs:{src:a(423),alt:""}})]),t._v(" "),e("h4",{attrs:{id:"port"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#port"}},[t._v("#")]),t._v(" port")]),t._v(" "),e("p",[t._v("要找到"),e("code",[t._v("port")]),t._v("值，只需在IOReg中选择你的USB端口并查找"),e("code",[t._v("port")]),t._v("条目:")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"left"}},[t._v("IOReg")]),t._v(" "),e("th",{staticStyle:{"text-align":"left"}},[t._v("info.plist")])])]),t._v(" "),e("tbody",[e("tr",[e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(424),alt:""}})]),t._v(" "),e("td",{staticStyle:{"text-align":"left"}},[e("img",{attrs:{src:a(425),alt:""}})])])])]),t._v(" "),e("p",[t._v("从这里我们得到"),e("code",[t._v("<03 00 00 00>")]),t._v("，你可以简单地删除任何空格并将其添加到你的USB映射中")]),t._v(" "),e("h4",{attrs:{id:"端口数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#端口数"}},[t._v("#")]),t._v(" 端口数")]),t._v(" "),e("p",[t._v("最后剩下的值，回头看看你的USB映射表，看看哪个"),e("code",[t._v("port")]),t._v("条目最大:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(426),alt:""}})]),t._v(" "),e("p",[t._v("这里我们看到PXSX(1)中最大的是"),e("code",[t._v("<04000000>")]),t._v("，请记住，如果您在USB map中获得任何字母，"),e("code",[t._v("port")]),t._v("使用十六进制。")]),t._v(" "),e("h3",{attrs:{id:"继续"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#继续"}},[t._v("#")]),t._v(" 继续")]),t._v(" "),e("p",[t._v("现在我们已经讨论了如何为特定的控制器映射USB端口，您应该有足够的理解来映射更多的控制器。我提供的示例USB-map.kext有3个USB控制器列在其中(PXSX-1, PXSX-2和XHCI)。记得相应地编辑并删除任何不必要的映射。")]),t._v(" "),e("h2",{attrs:{id:"清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#清理"}},[t._v("#")]),t._v(" 清理")]),t._v(" "),e("p",[t._v("一旦你保存了你的USB地图的 info.plist, 记得添加kext到你的 EFI/OC/Kexts 并添加到config.plist的 Kernel -> Add(ProperTree的快照可以为你做这件事)")]),t._v(" "),e("p",[t._v("接下来，删除/禁用:")]),t._v(" "),e("ul",[e("li",[t._v("USBInjectAll.kext(如果你正在使用它)\n"),e("ul",[e("li",[t._v("原因是USBInjectAll实际上破坏了Apple构建端口映射的方式。因此，虽然它对于初始端口映射很好，但它可能会破坏你最终的USB映射")])])]),t._v(" "),e("li",[t._v("Kernel -> Quirks -> XhciPortLimit -> False\n"),e("ul",[e("li",[t._v("现在我们终于低于15个端口的限制，我们不再需要这个黑客式的修复")])])])]),t._v(" "),e("p",[t._v("然后重新启动，最后一次检查IOReg:")]),t._v(" "),e("p",[e("img",{attrs:{src:a(427),alt:""}})]),t._v(" "),e("p",[t._v("瞧!如你所见，我们的USB地图应用成功!")]),t._v(" "),e("p",[t._v("需要验证的主要属性是:")]),t._v(" "),e("ul",[e("li",[t._v("正确设置Usb接口的Usb连接器属性")]),t._v(" "),e("li",[t._v("应用注释(如果注入)")]),t._v(" "),e("li",[t._v("移除未使用的端口")])])])}),[],!1,null,null,null);e.default=s.exports}}]);